<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>财务报表</title>
    <!-- Bootstrap 5 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" rel="stylesheet">
    <!-- AdminLTE -->
    <link href="https://cdn.jsdelivr.net/npm/admin-lte@3.2.0/dist/css/adminlte.min.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            line-height: 1.5;
            background-color: #f0f2f5;
        }

        .header {
            background-color: #fff;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .stat-card h3 {
            color: #606266;
            font-size: 14px;
            margin-bottom: 10px;
        }

        .stat-value {
            font-size: 24px;
            color: #303133;
        }

        .stat-value.negative {
            color: #F56C6C;
        }

        .stat-value .prefix {
            font-size: 16px;
            color: #909399;
        }

        .stat-value .suffix {
            font-size: 16px;
            color: #909399;
        }

        .charts-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-bottom: 20px;
        }

        .chart-card {
            background: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .chart-card h3 {
            color: #606266;
            margin-bottom: 20px;
        }

        .chart {
            height: 400px;
        }

        .details-card {
            background: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .details-card h3 {
            color: #606266;
            margin-bottom: 20px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #EBEEF5;
        }

        th {
            font-weight: 500;
            color: #606266;
            background-color: #FAFAFA;
        }

        td {
            color: #606266;
        }

        .amount {
            font-family: monospace;
        }

        .amount.negative {
            color: #F56C6C;
        }

        .info-box {
            min-height: 100px;
            background: #fff;
            width: 100%;
            box-shadow: 0 0 1px rgba(0,0,0,.125), 0 1px 3px rgba(0,0,0,.2);
            border-radius: 0.25rem;
            margin-bottom: 1rem;
            padding: 1rem;
        }

        .info-box-number {
            display: block;
            font-size: 1.5rem;
            font-weight: 700;
        }

        .info-box-text {
            display: block;
            font-size: 1rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .chart-container {
            background: #fff;
            padding: 1rem;
            margin-bottom: 1rem;
            box-shadow: 0 0 1px rgba(0,0,0,.125), 0 1px 3px rgba(0,0,0,.2);
            border-radius: 0.25rem;
        }

        .negative {
            color: #dc3545;
        }

        .table-container {
            background: #fff;
            padding: 1rem;
            margin-bottom: 1rem;
            box-shadow: 0 0 1px rgba(0,0,0,.125), 0 1px 3px rgba(0,0,0,.2);
            border-radius: 0.25rem;
        }

        .table th {
            background-color: #f8f9fa;
        }
    </style>
</head>
<body class="bg-light">
    <div class="container-fluid py-4">
        <div class="row mb-4">
            <div class="col-12">
                <h1 class="mb-4">25年1月卡卡财务报表</h1>
            </div>
        </div>

        <div class="row">
            <div class="col-12 col-sm-6 col-md-3">
                <div class="info-box">
                    <span class="info-box-text">车辆收入</span>
                    <span class="info-box-number">
                        ¥<span id="income">208,039.43</span>
                    </span>
                </div>
            </div>
            <div class="col-12 col-sm-6 col-md-3">
                <div class="info-box">
                    <span class="info-box-text">总支出</span>
                    <span class="info-box-number">
                        ¥<span id="expense">227,434.72</span>
                    </span>
                </div>
            </div>
            <div class="col-12 col-sm-6 col-md-3">
                <div class="info-box">
                    <span class="info-box-text">收支差额</span>
                    <span class="info-box-number negative">
                        ¥<span id="balance">-19,395.29</span>
                    </span>
                </div>
            </div>
            <div class="col-12 col-sm-6 col-md-3">
                <div class="info-box">
                    <span class="info-box-text">车辆利润率</span>
                    <span class="info-box-number">
                        <span id="profit">1.74</span>%
                    </span>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-12">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">关键财务指标分析</h3>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-12 col-sm-6 col-md-4 mb-4">
                                <div class="info-box bg-gradient-info">
                                    <div class="info-box-content">
                                        <span class="info-box-text">营业利润率</span>
                                        <span class="info-box-number" id="operatingMargin">-9.32%</span>
                                        <div class="progress">
                                            <div class="progress-bar" style="width: 9.32%"></div>
                                        </div>
                                        <span class="progress-description">
                                            <i class="bi bi-info-circle"></i>
                                            反映企业的盈利能力，数值越高越好
                                        </span>
                                        <small class="text-muted">计算方法：(收入-支出)/收入×100%</small>
                                    </div>
                                </div>
                            </div>
                            <div class="col-12 col-sm-6 col-md-4 mb-4">
                                <div class="info-box bg-gradient-success">
                                    <div class="info-box-content">
                                        <span class="info-box-text">人工成本率</span>
                                        <span class="info-box-number" id="laborCostRatio">54.72%</span>
                                        <div class="progress">
                                            <div class="progress-bar" style="width: 54.72%"></div>
                                        </div>
                                        <span class="progress-description">
                                            <i class="bi bi-info-circle"></i>
                                            反映人力成本占收入的比重
                                        </span>
                                        <small class="text-muted">计算方法：工资总额/收入×100%</small>
                                    </div>
                                </div>
                            </div>
                            <div class="col-12 col-sm-6 col-md-4 mb-4">
                                <div class="info-box bg-gradient-warning">
                                    <div class="info-box-content">
                                        <span class="info-box-text">管理费用率</span>
                                        <span class="info-box-number" id="managementExpenseRatio">12.09%</span>
                                        <div class="progress">
                                            <div class="progress-bar" style="width: 12.09%"></div>
                                        </div>
                                        <span class="progress-description">
                                            <i class="bi bi-info-circle"></i>
                                            反映管理成本的控制水平
                                        </span>
                                        <small class="text-muted">计算方法：管理费用/收入×100%</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-12">
                                <div class="card card-primary card-outline">
                                    <div class="card-header">
                                        <h3 class="card-title">财务分析建议</h3>
                                    </div>
                                    <div class="card-body">
                                        <div class="alert alert-info">
                                            <h5><i class="bi bi-lightbulb"></i> 本月要点：</h5>
                                            <ul>
                                                <li>营业利润率为负值(-9.32%)，说明经营存在亏损，需要关注成本控制</li>
                                                <li>人工成本率(54.72%)偏高，建议优化人员结构或提高人效</li>
                                                <li>管理费用率(12.09%)处于合理范围，但仍有优化空间</li>
                                            </ul>
                                        </div>
                                        <div class="alert alert-warning">
                                            <h5><i class="bi bi-exclamation-triangle"></i> 改进建议：</h5>
                                            <ul>
                                                <li>考虑适当提高车辆销售价格或寻找新的收入增长点</li>
                                                <li>优化人员结构，提高人均产值</li>
                                                <li>加强费用管控，特别是在招待费、宣传费等方面</li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-12 col-md-6">
                <div class="chart-container">
                    <h4>主要支出项目分布</h4>
                    <div id="expenseChart" class="chart"></div>
                </div>
            </div>
            <div class="col-12 col-md-6">
                <div class="chart-container">
                    <h4>收支概览</h4>
                    <div id="overviewChart" class="chart"></div>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-12">
                <div class="table-container">
                    <h4>支出明细</h4>
                    <div class="table-responsive">
                        <table class="table table-hover">
                            <thead>
                                <tr>
                                    <th>类别</th>
                                    <th>金额</th>
                                    <th>说明</th>
                                </tr>
                            </thead>
                            <tbody id="expenseDetails"></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap 5 -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- AdminLTE -->
    <script src="https://cdn.jsdelivr.net/npm/admin-lte@3.2.0/dist/js/adminlte.min.js"></script>
    <!-- ECharts -->
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <script>
        const financialData = {
            vehicleIncome: 208039.43,
            totalExpense: 227434.72,
            balance: -19395.29,
            profitMargin: 1.74,
            operatingMargin: -9.32,
            laborCostRatio: 54.72,
            managementExpenseRatio: 12.09,
            expenseDetails: [
                { 
                    category: '实付工资', 
                    amount: 113844.22, 
                    description: '郁总 22,721.63元，郑 27,914.93元，徐 10,899.87元，陈 3,649.74元，飞 6,000元，史 4,800元，阮 -1,311.26元，王益波提成 39,092.54元（未付）【邮政扣1月公积金2,250元，扣社保10,307.28元（单位4,812×25.2%=1,212.62元，个人4,812×10.5%=505.26元）；泰隆银行扣徐思凡社保1,727.51元（单位部分25.4%）+1月公积金250元；收回郁凌社保1,717.88元和公积金250元；1月份社保单位部分增收1%=48.12元】'
                },
                { 
                    category: '房租', 
                    amount: 34959.65, 
                    description: '25年1月房租 28,524.65元；承担装潢部1-2月房租 6,435元'
                },
                {
                    category: '物业管理', 
                    amount: 25048.4, 
                    description: '25.1物业费 5,520.9元；25年梅山展厅物业费 19,527.5元'
                },
                { 
                    category: '税金', 
                    amount: -3900, 
                    description: '威尔法正卜高开4,000元扣13%税点520元，余姚进项92.9万冲红2.3万补扣13%税点2,990元，埃尔法常成高开2,000元扣260元，装潢高开1,000元扣130元'
                },
                { 
                    category: '水电', 
                    amount: 700.69, 
                    description: '1月水电费：13.46 + 624.75 + 62.48 = 700.69元'
                },
                { 
                    category: '财务费用', 
                    amount: 2278.12, 
                    description: '邮政扣印花税 307.45元，泰隆银行扣印花税 1,810.67元，邮政扣手续费 80 + 80 = 160元'
                },
                { 
                    category: '招待费', 
                    amount: 7180, 
                    description: '招待费：4,180元 + 3,000元 = 7,180元'
                },
                { 
                    category: '宣传费', 
                    amount: 500, 
                    description: '马丁试驾视频：500元'
                },
                { 
                    category: '管理费用', 
                    amount: 25155.56, 
                    description: '1月停车费：700元，裱字：2,980元，资料邮费：12 + 26 = 38元，牛奶：129.6元，样车马工合同回寄：12元，汉堡：32元，药：19.46元，牛奶：100.5元，马丁试驾广告牌：36元，中饭：390元，水果：789元，统计会议买票路费：27 × 2 × 0.5 = 27元，饭卡充值：1,000元，烟：1,520元，大米：350元，年会餐费：6,888元，衢州菜：260元，茶叶三盒：590 × 3 = 1,770元，中午买菜：314元，苹果：1,800元，年费：6,000元'
                },
                { 
                    category: '融资利息', 
                    amount: 8901.17, 
                    description: '25年1月利息：23,978.17元，1月车辆利息：15,077元'
                },
                { 
                    category: '通讯费', 
                    amount: 200, 
                    description: '电话费：200元'
                }
            ]
        };

        function formatNumber(num) {
            return num.toLocaleString('zh-CN', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
        }

        // 初始化支出分布图表
        const expenseChart = echarts.init(document.getElementById('expenseChart'));
        const expenseData = financialData.expenseDetails
            .filter(item => item.amount > 0)
            .map(item => ({
                name: item.category,
                value: item.amount
            }));

        expenseChart.setOption({
            tooltip: {
                trigger: 'item',
                formatter: '{b}: ¥{c} ({d}%)'
            },
            legend: {
                orient: 'vertical',
                right: 10,
                top: 'center',
                type: 'scroll'
            },
            series: [{
                type: 'pie',
                radius: ['40%', '70%'],
                avoidLabelOverlap: true,
                itemStyle: {
                    borderRadius: 10,
                    borderColor: '#fff',
                    borderWidth: 2
                },
                label: {
                    show: true,
                    formatter: '{b}: {d}%'
                },
                emphasis: {
                    label: {
                        show: true,
                        fontSize: 16,
                        fontWeight: 'bold'
                    }
                },
                data: expenseData
            }]
        });

        // 初始化收支概览图表
        const overviewChart = echarts.init(document.getElementById('overviewChart'));
        overviewChart.setOption({
            tooltip: {
                trigger: 'axis',
                axisPointer: {
                    type: 'shadow'
                }
            },
            grid: {
                left: '3%',
                right: '4%',
                bottom: '3%',
                containLabel: true
            },
            xAxis: {
                type: 'value',
                axisLabel: {
                    formatter: '¥{value}'
                }
            },
            yAxis: {
                type: 'category',
                data: ['收入', '支出', '结余']
            },
            series: [{
                name: '金额',
                type: 'bar',
                data: [
                    { value: financialData.vehicleIncome, itemStyle: { color: '#28a745' } },
                    { value: financialData.totalExpense, itemStyle: { color: '#dc3545' } },
                    { value: financialData.balance, itemStyle: { color: financialData.balance >= 0 ? '#28a745' : '#dc3545' } }
                ],
                label: {
                    show: true,
                    formatter: '¥{c}'
                }
            }]
        });

        // 填充支出明细表格
        const tbody = document.getElementById('expenseDetails');
        financialData.expenseDetails.forEach(item => {
            const tr = document.createElement('tr');
            tr.innerHTML = `
                <td>${item.category}</td>
                <td class="${item.amount < 0 ? 'negative' : ''}">${formatNumber(item.amount)}</td>
                <td>${item.description}</td>
            `;
            tbody.appendChild(tr);
        });

        // 监听窗口大小变化
        window.addEventListener('resize', () => {
            expenseChart.resize();
            overviewChart.resize();
        });
    </script>
</body>
</html>
